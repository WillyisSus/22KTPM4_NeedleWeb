<!doctype html>
<html lang="en">

<head>
    <title>Profile</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <!-- Bootstrap CSS v5.2.1 -->
    <link href="/node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Bootstrap Icon -->
    <link rel="stylesheet" href="/node_modules/bootstrap-icons/font/bootstrap-icons.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="./css/components.css">
    <link rel="stylesheet" href="./css/thread-feed-display.css">
    <link href="/src/profile/profile.css" rel="stylesheet">


</head>

<body>
    <header>
        <!-- place navbar here -->
    </header>
    <main>
        <!-- Side bar -->
        <div class=" desktop-navbar">
            <div class="navbar-logo">
                <img src="./images/svg/logo.svg" alt="logo">
            </div>
            <ul class="nav">
                <li class="nav-item">
                    <a class="nav-link active" href="#" aria-current="page"><i class="bi bi-house-door-fill"></i>
                        <span>Home</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="#" aria-current="page"><i class="bi bi-search"></i>
                        <span>Search</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="#" aria-current="page"><i class="bi bi-plus-lg"></i>
                        <span>Post</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="#" aria-current="page"><i class="bi bi-bell-fill"></i>
                        <span>Notification</span></a>
                </li>
                <li class="nav-item" id="profile">
                    <a class="nav-link active" href="#" aria-current="page"><i class="bi bi-person-circle"></i>
                        <span>Profile</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="#" aria-current="page"><i class="bi bi-arrow-bar-left"></i>
                        <span>Logout</span></a>
                </li>
            </ul>
        </div>
        <!-- Thread area -->
        <div id="thread-display-section">
            <div id="top-bar" class="dropdown open">
                @username
            </div>

            <div class="thread-container" id="thread-container">
                <div class="profile-container">
                    <div class="d-flex flex-row justify-content-between" style="margin-bottom:10px">
                        <div>
                            <h4><b>Display Name</b></h4>
                            Username
                        </div>
                        <div class="avatar-and-follow-icon">
                            <img data-bs-toggle="modal" data-bs-target="#changeAvatar" src="/src/images/avatar.png"
                                alt="avatar" class="border border-1 border-dark rounded-circle"
                                style="width: 66px; height:66px;">
                        </div>
                    </div>
                    <div>
                        bio
                    </div>

                    <div class="d-flex flex-column flex-md-row justify-content-between">
                        <div data-bs-toggle="modal" data-bs-target="#followModal" style="color:grey;">
                            9,999 followers ‚óè 9,999 following
                        </div>

                        <a data-bs-toggle="modal" data-bs-target="#editProfile" role="button"
                            class="btn btn-dark col-12 col-md-3" style=" margin-top: 10px">
                            Edit Info
                        </a>

                    </div>

                    <div
                        style="text-align: center; border-top: 2px solid lightgray; border-bottom: 2px solid lightgray; padding: 10px 0px; margin: 10px 0px">
                        Threads of @username
                    </div>

                    <!-- Threads -->

                    <div class="d-flex flex-row justify-content-between" style="padding: 12px 24px">
                        <div class="avatar-and-follow-icon">
                            <img src="/src/images/avatar.png" alt="avatar"
                                class="border border-1 border-dark rounded-circle" style="width: 36px; height:36px;">
                        </div>
                        <div style="padding: 8px; width: 100%;">
                            <div class="border-0 bg-white border-black rounded-0 p-0">
                                <div class="username-date d-flex justify-content-between">
                                    <span>
                                        <p class="fw-bold d-inline-block my-0">Username</p>
                                        <i class="bi bi-clock"></i>
                                        <span>dd/mm/yyyy</span>
                                    </span>
                                </div>
                            </div>
                            <div class="card-body p-0" style="margin: 8px 0">
                                <div class="">Lorem ipsum dolor sit amet consectetur adipisicing elit. Quas, nulla?
                                </div>
                            </div>

                            <div class="card-footer bg-white border-top-0 p-0">
                                <p class="d-inline-block"><i class="bi bi-chat-left-text"></i> Replies</p>
                                <p class="d-inline-block"><i class="bi bi-heart"></i> Likes</p>
                            </div>
                        </div>
                        <div>
                            <i class="bi bi-three-dots"></i>
                        </div>

                    </div>



                    <!-- Modal for 'follow-' -->
                    <div class="modal fade" id="followModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="row">
                                    <div id="followersCol" class="d-flex flex-column justify-content-center col"
                                        style="font-weight: bold;">
                                        <div style="text-align: center;">Followers</div>

                                        <div style="text-align: center; border-bottom: 2px solid;">9,999</div>

                                    </div>

                                    <div id="followingCol" class="d-flex flex-column justify-content-center col">
                                        <div style="text-align: center;">Following</div>

                                        <div style="text-align: center; border-bottom: 2px solid;">9,999</div>

                                    </div>
                                </div>
                                <div id="followModalBody" class="modal-body overflow-scroll d-flex flex-column gap-2"
                                    style="max-height: 500px;">

                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Modal for 'edit-profile' -->
                    <div class="modal fade" id="editProfile" tabindex="-1" aria-labelledby="exampleModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Updating Profile</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <form class="d-flex flex-column gap-2">
                                        <div class="form-group">
                                            <label for="Name"><b>Name</b></label>
                                            <input id="Name" class="form-control" value="Name">
                                        </div>
                                        <div class="form-group">
                                            <label for="bio"><b>Bio</b></label>
                                            <input id="bio" class="form-control">
                                        </div>
                                    </form>


                                </div>
                                <div class="modal-footer justify-content-center">
                                    <button type="submit" class="btn btn-dark">Save changes</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Modal for 'change-avatar' -->
                    <div class="modal fade" id="changeAvatar" tabindex="-1" aria-labelledby="exampleModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog">

                            <div class="modal-content p-2">
                                <div class="modal-header justify-content-center" style="text-align: center;">
                                    <img src="/src/images/avatar.png" alt="avatar"
                                        class="border border-1 border-dark rounded-circle"
                                        style="width: 56px; height:56px;">
                                </div>

                                <div class="modal-body d-flex flex-column gap-2">
                                    <button type="submit" class="btn btn-outline-dark">From Device</button>
                                    <button type="submit" class="btn btn-outline-dark">From Site</button>
                                    <button type="submit" class="btn btn-outline-danger">Remove Avatar</button>

                                </div>
                                <div class="modal-footer justify-content-center">
                                    <button type="submit" class="btn btn-dark">Save changes</button>
                                </div>

                            </div>

                        </div>
                    </div>


                </div>
            </div>

    </main>
    <footer>
        <!-- place footer here -->
    </footer>
    <script src="./scripts/header.js"></script>

    <script>
        let modalBodyFollowing;
        let modalBodyFollowers;
        let promises = [];
        ['followers', 'following'].forEach((type) => {
            promises.push(fetch(`/src/profile/modal-body-${type}.html`));
        });
        Promise.all(promises).then((responses) => {
            return Promise.all(responses.map((response) => response.text()));
        }).then((texts) => {
            modalBodyFollowers = new DOMParser().parseFromString(texts[0], 'text/html').body.firstChild;
            modalBodyFollowing = new DOMParser().parseFromString(texts[1], 'text/html').body.firstChild;
            let modalBody = document.getElementById('followModalBody');
            for (let i = 0; i < 5; i++) {
                modalBody.appendChild(modalBodyFollowers.cloneNode(true));
            }

            let followersEl = document.getElementById('followersCol');
            let followingEl = document.getElementById('followingCol');
            [followersEl, followingEl].forEach((el) => {
                el.addEventListener('click', () => {
                    if (el.style.fontWeight === 'bold') {
                        return;
                    }
                    modalBody.innerHTML = '';
                    el.style.fontWeight = 'bold';
                    if (el === followersEl) {
                        followingEl.style.fontWeight = 'normal';
                        for (let i = 0; i < 5; i++) {
                            modalBody.appendChild(modalBodyFollowers.cloneNode(true));
                        }
                    } else {
                        followersEl.style.fontWeight = 'normal';
                        for (let i = 0; i < 5; i++) {
                            modalBody.appendChild(modalBodyFollowing.cloneNode(true));
                        }
                    }
                });
            });
        });





    </script>
    <script src="/src/profile/profile-script.js"></script>

    <!-- Bootstrap JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
        crossorigin="anonymous"></script>
</body>

</html>